#cloud-config
users:
  - name: cloud-admin
    ssh-authorized-keys: {{ .AuthorizedKeys }}
    sudo: ['ALL=(ALL) NOPASSWD:ALL']
    shell: /bin/bash
{{- if .NodeRootPassword }}
chpasswd:
  list: |
    root:{{ .NodeRootPassword }}
  expire: False
{{- end }}
bootcmd:
  - "mkdir -p /mnt/kubeconfig"
  - "mkdir -p /root/kubeconfig"
  - "mount /dev/disk/by-id/virtio-fencingdisk /mnt/kubeconfig"
  - "cp -f /mnt/kubeconfig/* /root/kubeconfig/."
  - "chown -R root:root /root/kubeconfig"
  - "chmod -R 0600 /root/kubeconfig"
  - "umount /mnt/kubeconfig"